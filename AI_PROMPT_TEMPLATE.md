# AI_PROMPT_TEMPLATE.md — 開発用AIプロンプトひな型

このドキュメントは、本リポジトリで **AI（ChatGPT / Codex 等）に開発作業を依頼する際の共通テンプレート** です。
新規チャットでも開発文脈を失わず、安全に PR ベース開発を継続することを目的とします。

---

## 前提（AIに必ず守らせること）

* 対象リポジトリ: [https://github.com/yuichiohryh-oss/cr](https://github.com/yuichiohryh-oss/cr)
* 基点ブランチ: master
* 開発対象は C# / .NET / WinForms
* OpenCV は使用しない（System.Drawing ベース）
* 既存設計判断は前提として尊重する（詳細は AGENTS.md を参照）
* 破壊的変更は禁止。必要な場合は理由・影響範囲・代替案を明示

---

## 共通ルール（最重要）

AI に必ず以下を守らせること。

1. **実装前に必ず `dotnet build` / `dotnet test` を実行し、成功を確認すること**
2. **実装後も必ず `dotnet build` / `dotnet test` を実行し、成功時のみ PR を作成すること**
3. 失敗した場合は **PR を作らず**、失敗理由と修正方針のみを報告すること
4. コード全文はチャットに貼らない（変更点・ファイル一覧・要点のみ）
5. 既存の Recorder / Inspector / Viewer の挙動を壊さない

---

## ブランチ・コミット・PR規約

* ブランチは purpose が分かる名前にする

  * 例: `feature/...`, `docs/...`, `fix/...`
* コミットは意味単位で分ける（目安 1〜2 個）
* PR は小さく、レビューしやすく

---

## 基本プロンプトひな型（そのまま使う）

```text
あなたは熟練のC#/.NETエンジニアです。
リポジトリ https://github.com/yuichiohryh-oss/cr の master を基点に、
以下の目的を満たす機能追加・修正を行ってください。

【目的】
（ここに目的を書く）

重要:
- コード全文はチャットに貼らない
- ブランチ作成 → コミット → PR作成まで行う
- PRは dotnet build / dotnet test が成功した場合のみ作成
- 既存の設計（per-match JSONL、相対パス、Resolver方式、System.Drawing）を壊さない

==================================================
【最重要ルール】
1) 実装前に master で dotnet build / dotnet test を実行し成功確認
2) 実装後も dotnet build / dotnet test を実行し成功時のみ PR 作成
3) 失敗したらPR作らず、失敗理由と修正方針のみ報告

==================================================
仕様詳細
（ここに詳細仕様を書く）

==================================================
Git / PR
- ブランチ: （ここにブランチ名）
- コミット:
  1) （コミット1）
  2) （コミット2）
- PRタイトル:
  （PRタイトル）

==================================================
実行手順
【事前確認】
1) git checkout master
2) git pull --rebase
3) dotnet build
4) dotnet test

【ブランチ作成】
5) git checkout -b <branch>

【実装→確認】
6) 実装
7) dotnet build
8) dotnet test

【成功時のみ】
9) git commit（必要回数）
10) git push -u origin <branch>
11) gh pr create --base master ...

==================================================
チャットに返す内容（コード全文は不要）
- 実行したコマンド一覧
- dotnet build / dotnet test の成否
- PR URL
- 変更ファイル一覧（パスのみ）
- 仕様上の注意点（あれば）
```

---

## レビュー・修正用プロンプトひな型

```text
あなたは熟練のC#/.NETエンジニアです。
次の PR を基点に、レビューコメントで指摘された内容を
**コメントではなくコード修正として** 反映してください。

対象PR:
（PR URL）

重要:
- 既存 PR のブランチを更新する（新規PRは作らない）
- dotnet build / dotnet test が成功した場合のみ push する
- 失敗したら push せず、原因と修正方針のみ報告

（以下、修正内容を列挙）
```

---

## よくある失敗と防止策

* レビューコメントだけ書いてコードを直さない

  * → 「必ずコードを修正してコミットする」と明示する
* build/test を実行しない

  * → 最重要ルールを冒頭に書く
* 設計前提を壊す

  * → AGENTS.md を参照させる

---

## このテンプレの使い方

1. 新規チャット開始時に、このテンプレをベースに依頼を書く
2. 必要に応じて仕様詳細だけ差し替える
3. AGENTS.md と併用することで文脈ロスを防ぐ

---

このドキュメントは「AIを開発メンバーとして安定運用する」ための基盤です。
プロジェクトの進化に合わせて更新してください。
